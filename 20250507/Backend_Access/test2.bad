æ ¹æ“šä½ æä¾›çš„å®Œæ•´ç¨‹å¼ç¢¼é‚è¼¯èˆ‡ WriteLog ç´€éŒ„ï¼Œè¼¸å…¥çš„ gReportNames(i) çœ‹èµ·ä¾†æ˜¯æ­£ç¢ºçš„ï¼ˆå¦‚ CNY1, FB2, FM11, AI821ï¼‰ï¼Œä½†å¾ŒçºŒä»ç„¶å‡ºç¾ "æœªçŸ¥çš„å ±è¡¨åç¨±"ï¼Œé€™ä»£è¡¨åœ¨ Select Case rptName æ¯”å°æ™‚æ²’æœ‰ç¬¦åˆä»»ä½• Caseï¼Œé€²å…¥äº† Case Else å€å¡Šã€‚

é€™ç¨®ç‹€æ³çš„å¸¸è¦‹åŸå› å¦‚ä¸‹ï¼š

â¸»

âœ… 1. éš±è—å­—å…ƒæˆ–ä¸å¯è¦‹ç©ºæ ¼å­˜åœ¨

å³ä½¿ä½ è¼¸å…¥çš„æ˜¯ "CNY1"ï¼Œä½†å¦‚æœå­—ä¸²ä¸­åŒ…å« ä¸å¯è¦‹çš„ç©ºæ ¼ã€æ›è¡Œç¬¦è™Ÿæˆ–å…¨å½¢å­—å…ƒï¼Œåœ¨ Select Case è£¡é¢æœƒç„¡æ³•åŒ¹é…æˆåŠŸã€‚

ğŸ” æª¢æŸ¥æ–¹å¼ï¼š

åœ¨ Select Case å‰é¢åŠ ä¸Šï¼š

WriteLog "æª¢æŸ¥å ±è¡¨åç¨±: [" & rptName & "]ï¼Œé•·åº¦: " & Len(rptName)

ç¯„ä¾‹è¼¸å‡ºå¯èƒ½æœƒæ˜¯ï¼š

æª¢æŸ¥å ±è¡¨åç¨±: [CNY1 ]ï¼Œé•·åº¦: 5

å°±èƒ½ç™¼ç¾å¤šäº†ä¸€å€‹ç©ºæ ¼æˆ–æ§åˆ¶å­—å…ƒã€‚

â¸»

âœ… 2. ä½¿ç”¨è€…è¼¸å…¥ä¸­çš„é€—è™Ÿæˆ–æ–‡å­—ä¸æ˜¯åŠå½¢

ä¾‹å¦‚ä½ è¼¸å…¥ï¼š

CNY1ï¼ŒFB2ï¼ŒFM11ï¼ŒAI821

é€™æ˜¯ å…¨å½¢é€—è™Ÿï¼ˆï¼Œï¼‰ï¼Œä¸æ˜¯åŠå½¢é€—è™Ÿï¼ˆ,ï¼‰ã€‚é‚£éº¼ Split(userInput, ",") å°±ä¸æœƒæ­£ç¢ºåˆ†å‰²æˆä½ é æœŸçš„å ±è¡¨æ¸…å–®ã€‚

âœ… è§£æ±ºæ–¹å¼ï¼š

æŠŠé€—è™Ÿæ›¿æ›è™•ç†æ“´å±•å¦‚ä¸‹ï¼š

userInput = Replace(userInput, " ", "")
userInput = Replace(userInput, "ï¼Œ", ",") ' â† åŠ ä¸Šé€™ä¸€è¡Œï¼Œè™•ç†å…¨å½¢é€—è™Ÿ
gReportNames = Split(userInput, ",")


â¸»

âœ… 3. å¤šé¤˜çš„æ›è¡Œç¬¦è™Ÿæˆ– Tab å­—å…ƒ

æœ‰æ™‚å€™è¤‡è£½è²¼ä¸Šæœƒæ„å¤–å¸¶å…¥ vbCr, vbLf, vbTab ç­‰æ§åˆ¶å­—å…ƒã€‚é€™æœƒè®“ Select Case ç„¡æ³•æ¯”å°æˆåŠŸã€‚

âœ… å»ºè­°åŠ å…¥æ¨™æº–åŒ–æ¸…æ´—ç¨‹å¼ï¼š

For i = LBound(gReportNames) To UBound(gReportNames)
    gReportNames(i) = UCase(Trim(Replace(gReportNames(i), vbTab, "")))
Next i

ä¹Ÿå¯æ›´å¼·åŒ–ä¸€é»çš„æ¸…æ´—æ–¹å¼ï¼š

Function CleanReportName(name As String) As String
    Dim tmp As String
    tmp = Replace(name, vbTab, "")
    tmp = Replace(tmp, vbCrLf, "")
    tmp = Replace(tmp, vbCr, "")
    tmp = Replace(tmp, vbLf, "")
    tmp = Trim(tmp)
    CleanReportName = UCase(tmp)
End Function

ç„¶å¾Œä½¿ç”¨ï¼š

For i = LBound(gReportNames) To UBound(gReportNames)
    gReportNames(i) = CleanReportName(gReportNames(i))
Next i


â¸»

âœ… 4. Select Case æœ‰æ™‚å€™ä¸å¦‚ If ç²¾æº–

æœ‰äº› VBA ç‰ˆæœ¬æˆ–æ¢ä»¶ä¸‹ Select Case çš„æ¯”å°ä¸æ˜¯å®Œå…¨å­—å…ƒç­‰å€¼æ¯”å°ï¼Œå¯èƒ½ä¹Ÿæœƒå—æ ¼å¼å½±éŸ¿ã€‚æˆ‘å€‘é€šå¸¸åŠ ä¸Š Trim + UCase æ˜¯è‰¯å¥½åšæ³•ã€‚

â¸»

âœ… ç¸½çµå»ºè­°ï¼š

è«‹ä½ è©¦è‘—åœ¨ For Each rptName In gReportNames å‰åŠ é€™ä¸€æ®µæš«æ™‚è¨ºæ–·ï¼š

WriteLog "â–¶ æ¯”å°å‰ rptName: [" & rptName & "], Len: " & Len(rptName)

æ¥è‘—æŠŠ Select Case æ”¹æˆæ›´ä¿éšªçš„æ–¹å¼ï¼š

Select Case Trim(UCase(rptName))
    Case "CNY1":    Call Process_CNY1
    Case "FB1":     Call Process_FB1
    Case "FB2":     Call Process_FB2
    Case "FB3":     Call Process_FB3
    Case "FB3A":    Call Process_FB3A
    Case "FM5":     Call Process_FM5
    Case "FM11":    Call Process_FM11
    Case "FM13":    Call Process_FM13
    Case "AI821":   Call Process_AI821
    Case "TABLE2":  Call Process_Table2
    Case "FB5":     Call Process_FB5
    Case "FB5A":    Call Process_FB5A
    Case "FM2":     Call Process_FM2
    Case "FM10":    Call Process_FM10
    Case "F1_F2":   Call Process_F1_F2
    Case "TABLE41": Call Process_Table41
    Case "AI602":   Call Process_AI602
    Case "AI240":   Call Process_AI240
    Case "AI822":   Call Process_AI822
    Case Else
        MsgBox "æœªçŸ¥çš„å ±è¡¨åç¨±: [" & rptName & "]", vbExclamation
        WriteLog "æœªçŸ¥çš„å ±è¡¨åç¨±: [" & rptName & "]"
End Select

é€™æ¨£å¯ä»¥æŠŠå¤šé¤˜å­—å…ƒå»é™¤æ‰ï¼Œä¿è­‰æ¯”å°æˆåŠŸã€‚

â¸»

å¦‚æœä½ å¸Œæœ›æˆ‘å¹«ä½ å¯«ä¸€æ®µè‡ªå‹•æ¸…æ´— gReportNames çš„æ¨¡çµ„ï¼Œè®“æœªä¾†ä¸è«–è¼¸å…¥æ€éº¼æ¨£éƒ½èƒ½æ­£å¸¸é‹ä½œï¼Œä¹Ÿå¯ä»¥å‘Šè¨´æˆ‘ï¼Œæˆ‘å¹«ä½ åšã€‚